name: Simple CI trigger

on:
  workflow_call:

jobs:
  Build-WebApp:
    name: Build simple node webapp
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Login to DockerHub
      uses: docker/login-action@v3
      with:
        username: ${{ secrets.DOCKERHUB_USERNAME }}
        password: ${{ secrets.DOCKERHUB_TOKEN }}
    - name: run tests
      run: ls -ltr
    - name: Get current date and time format
      id: date
      run: echo "::set-output name=date::$(date +'%Y%m%d%H%M%S')"
    - name: echo current date and time
      run: echo ${{ steps.date.outputs.date }}
    - name: setup latest app version
      if: ${{ github.event.ref == 'refs/heads/main' || github.event.ref == 'refs/heads/develop' }}
      run: |
        if [[ ${{ github.event.ref }} == 'refs/heads/main' ]]; then
          echo "It is main branch. hence, we will create release tag"
        elif [[ ${{ github.event.ref }} == 'refs/heads/develop' ]]; then
           echo "It is main branch. hence, we will create snapshot tag"
        fi
